# CartServiceTestTask

### Развертывание

* В основной проект не включен никакой механизм миграций, поэтому необходимо иметь рабочий _postgreSQL_ сервер, в котором выполнить [скрипт инициализации].
* Во всех _appsetings.json_ прописать корректные строки подключения.
* Далее необходимо выполнить EF миграции в рамках проекта [IdentityService].

### Тестирование функционала
Прежде, чем начать тестировать функционал api необходимо зарегистрировать пользователя при помощи запроса _register_ в [postman коллекции], либо убрать _AuthorizeAttribute_ с тестируемых методов.

Если пользователь зарегестрирован, то вместо текущего ID пользователя в [postman коллекции], подставить _ID_ вновь созданного.
Далее необходимо получить токен при помощи запроса _getToken_ и подставить его в заголовки вызываемых методов.

Api отлаживался только в режиме _SelfHost_, поэтому возможны какие-то ошибки при тестрировании в отличных от него режимах.

### Постановка задачи
**Дано**:
Модель продукта
```csharp
class Product
{
    public int Id { get; set; }
    public string Name { get; set; }
    public decimal Cost { get; set; }
    public bool ForBonusPoints { get; set; }
}
```
**Задача**:
Реализовать сервис корзины CartService

**Требования**:
1. **Стэк**: Asp Net Core 3 WEB Api + хранилище на выбор Redis / Sql Server / PostgreSQL + Dapper

2. **Функционал**:
    1) Добавление / удаление произвольного числа продуктов
    2) Данные о корзине хранить в течение 30 дней
    3) Возможность регистрации веб хуков, которые нужно дергать при удалении корзины по истечению срока хранения
    4) 1 раз в сутки генерировать и сохранять отчет (txt/pdf/excel на выбор), в котором будет указано:
        * сколько всего корзин
        * сколько из них содержат продукты за баллы
        * сколько корзин истечет в течение 10/20/30 дней
        * средний чек корзины


[postmanLink]: <https://www.getpostman.com/collections/a23e9f0cd48f5e571529>
[postman коллекции]: <https://www.getpostman.com/collections/a23e9f0cd48f5e571529>
[скрипт инициализации]: <https://github.com/ivan-man/CartServiceTestTask/blob/master/CartService/Migrations/up/001_CreateDb.sql>
[IdentityService]: <https://github.com/ivan-man/CartServiceTestTask/tree/master/IdentityService>

